
* Clojure test-is results in twitter
 
Here's a way, using clojure, to get your tests results showing on
twitter.

This is useful for example if you have regression tests that run
automatically once a week(like i have) that then post the results in
twitter.
 
Start by getting /jtwitter/, put it in your classphath and create:

#+BEGIN_SRC clojure
(import 'winterwell.jtwitter.Twitter)

(defn twitter-update [the_message]
  (let [twitter (new Twitter "username" "password")]
    (.updateStatus twitter the_message)))
#+END_SRC

Update "username" and "password" with your twitter login.

Then hook it up to the /test-is'/library(test library in clojure):
just overwrite the report summary method that by default prints out
the summary of the executed tests.

Before:

#+BEGIN_SRC clojure
(defmethod report :summary [m]
  (with-test-out
    (println "\nRan" (:test m) "tests containing"
    (+ (:pass m) (:fail m) (:error m)) "assertions.")
    (println (:fail m) "failures," (:error m) "errors.")))
#+END_SRC

After:

#+BEGIN_SRC clojure
(defmethod report :summary [m]
  (with-test-out
    (twitter-update (str "[coverager] " (:fail m) " failures, " (:error m) " errors."))
    (println "\nRan" (:test m) "tests containing"
    (+ (:pass m) (:fail m) (:error m)) "assertions.")
    (println (:fail m) "failures," (:error m) "errors.")))
#+END_SRC

Note that i just added added a line calling the twitter-update method.

And thats it, now every time you run your tests, you will have the
failures and errors twittered

[[/img/clj-twitter-alert.png]]

I've created a 2nd account on twitter where i post these automated
messages. And have my clojure tests(regression tests actually) running
by themselves and i just check twitter to see if all good.

This little twitter-update method is very easy to use for any other
alerts and automations.
